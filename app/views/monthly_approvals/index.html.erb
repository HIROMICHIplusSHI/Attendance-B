<div class="modal-header">
  <h4 class="modal-title">申請者からの1ヶ月分の勤怠申請</h4>
  <button type="button" class="close" data-action="modal#close">&times;</button>
</div>

<% if flash[:notice] %>
  <div class="alert alert-success" style="margin: 15px;">
    <%= flash[:notice] %>
  </div>
<% end %>

<% if flash[:alert] %>
  <div class="alert alert-danger" style="margin: 15px;">
    <%= flash[:alert] %>
  </div>
<% end %>

<%= form_with url: bulk_update_monthly_approvals_path, method: :patch, local: true do |f| %>
  <div class="modal-body">
    <% if @approvals.any? %>
      <table class="table table-bordered table-striped">
        <thead>
          <tr>
            <th>月</th>
            <th>指示者確認印</th>
            <th>変更</th>
            <th>勤怠を確認する</th>
          </tr>
        </thead>
        <tbody>
          <% @approvals.each do |approval| %>
            <tr>
              <td><%= l(approval.target_month, format: :middle) %></td>
              <td>
                <%= f.select "approvals[#{approval.id}][status]",
                    options_for_select([
                      ['申請中', 'pending'],
                      ['承認', 'approved'],
                      ['否認', 'rejected']
                    ], approval.status),
                    {},
                    class: "form-control" %>
              </td>
              <td class="text-center">
                <%= f.check_box "approvals[#{approval.id}][selected]", {}, '1', '0' %>
              </td>
              <td class="text-center">
                <%= link_to "確認",
                    user_path(approval.user, month: approval.target_month),
                    target: "_blank",
                    rel: "noopener noreferrer",
                    class: "btn btn-info btn-sm" %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <p class="text-center text-muted">承認待ちの申請はありません</p>
    <% end %>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-default" data-action="modal#close">キャンセル</button>
    <% if @approvals.any? %>
      <%= f.submit "変更を送信する", class: "btn btn-primary" %>
    <% end %>
  </div>
<% end %>
